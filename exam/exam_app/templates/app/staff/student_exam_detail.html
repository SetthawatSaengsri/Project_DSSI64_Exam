<!-- app/staff/student_exam_detail.html -->

{% extends 'app/base.html' %}

{% load custom_filters %}

{% block content %}
<div class="container mx-auto px-6 py-10">
    <h2 class="text-3xl font-bold text-indigo-700 text-center mb-6">üìå ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≠‡∏ö - {{ subject.subject_name }}
    </h2>

    <div class="overflow-x-auto">
        <table class="min-w-full bg-white border border-gray-300 rounded-lg shadow-md text-center">
            <thead class="bg-indigo-600 text-white">
                <tr>
                    <th class="py-3 px-4 border-b">#</th>
                    <th class="py-3 px-4 border-b">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                    <th class="py-3 px-4 border-b">‡∏ä‡∏∑‡πà‡∏≠</th>
                    <th class="py-3 px-4 border-b">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</th>
                    <th class="py-3 px-4 border-b">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏™‡∏≠‡∏ö</th>
                    <th class="py-3 px-4 border-b">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                    <th class="py-3 px-4 border-b">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
                {% for student in students %}
                <tr class="hover:bg-gray-100 transition duration-200">
                    <td class="py-3 px-4 border-b">{{ forloop.counter }}</td>
                    <td class="py-3 px-4 border-b">{{ student.student_id }}</td>
                    <td class="py-3 px-4 border-b">{{ student.user.first_name }} {{ student.user.last_name }}</td>
                    <td class="py-3 px-4 border-b">{{ student.student_class }}</td>
                    <td class="py-3 px-4 border-b">{{ student.seatingplan_set.first.seat_number|default:"-" }}</td>
                    <td class="py-3 px-4 border-b text-center">
                        {% if attendance_data|get_item:student.id %}
                            {% if attendance_data|get_item:student.id.status == 'on_time' %}
                                <span class="text-green-600">‡∏°‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤</span>
                            {% elif attendance_data|get_item:student.id.status == 'late' %}
                                <span class="text-yellow-600">‡∏°‡∏≤‡∏™‡∏≤‡∏¢</span>
                            {% else %}
                                <span class="text-red-600">‡∏Ç‡∏≤‡∏î‡∏™‡∏≠‡∏ö</span>
                            {% endif %}
                        {% else %}
                            <span class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</span>
                        {% endif %}
                    </td>
                    <td class="py-3 px-4 border-b">
                        {% if attendance_data[student.id] %}
                        {{ attendance_data[student.id].checkin_time|time:"H:i" }}
                        {% else %}
                        -
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="mt-6">
        <a href="{% url 'select_exam_subject' %}"
            class="bg-indigo-600 text-white px-6 py-3 rounded-lg shadow-md hover:bg-indigo-700 transition">
            üîô ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ä‡∏≤
        </a>
    </div>
</div>
{% endblock %}
