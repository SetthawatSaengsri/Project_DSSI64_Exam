<!-- exam_subjects_staff -->

{% extends "app/base.html" %}

{% block content %}
<div class="container mx-auto mt-10 max-w-7xl px-4 md:px-12">
    <div class="bg-white shadow-lg rounded-xl p-10">
        <h2 class="text-4xl font-bold text-indigo-700 text-center mb-8">üìö ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
        <p class="text-xl text-gray-600 text-center">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <span class="font-semibold text-indigo-600">{{ school_name }}</span></p>

        <!-- ‚úÖ Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô -->
        <div class="flex justify-center mb-8">
            <form method="GET" class="flex items-center space-x-4" id="classForm">
                <label for="student_class" class="text-lg text-gray-600">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label>
                <select name="student_class" id="student_class" class="border border-gray-300 p-2 rounded-md w-56 shadow-md" onchange="document.getElementById('classForm').submit();">
                    <option value="all" {% if selected_class == 'all' %}selected{% endif %}>-- ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                    {% for class in classes %}
                    <option value="{{ class }}" {% if class == selected_class %}selected{% endif %}>{{ class }}</option>
                    {% endfor %}
                </select>
            </form>
        </div>
        
        <div class="overflow-x-auto shadow-lg rounded-lg mt-8">
            <table class="w-full table-auto bg-white border border-gray-300 rounded-lg">
                <thead class="bg-indigo-700 text-white text-sm md:text-base">
                    <tr>
                        <th class="py-4 px-6 text-left font-semibold min-w-[200px]">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤</th>
                        <th class="py-4 px-6 text-left font-semibold min-w-[120px]">‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤</th>
                        <th class="py-4 px-6 text-left font-semibold min-w-[100px]">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</th>
                        <th class="py-4 px-6 text-left font-semibold min-w-[150px]">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ö</th>
                        <th class="py-4 px-6 text-left font-semibold min-w-[180px]">‡πÄ‡∏ß‡∏•‡∏≤</th>
                        <th class="py-4 px-6 text-left font-semibold min-w-[120px]">‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö</th>
                        <th class="py-4 px-6 text-left font-semibold min-w-[200px]">‡∏ú‡∏π‡πâ‡∏Ñ‡∏∏‡∏°‡∏™‡∏≠‡∏ö</th>
                        <th class="py-4 px-6 text-left font-semibold min-w-[220px]">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                </thead>
                <tbody class="text-gray-800 text-sm md:text-base">
                    {% for subject in subjects %}
                    <tr class="hover:bg-indigo-50 transition">
                        <td class="py-4 px-6 border-b min-w-[200px]">{{ subject.subject_name }}</td>
                        <td class="py-4 px-6 border-b min-w-[120px] whitespace-nowrap">{{ subject.subject_code }}</td>
                        <td class="py-4 px-6 border-b min-w-[100px]">{{ subject.academic_year }}</td>
                        <td class="py-4 px-6 border-b min-w-[150px]">{{ subject.exam_date }}</td>
                        <td class="py-4 px-6 border-b min-w-[180px] whitespace-nowrap">
                            {{ subject.start_time }} - {{ subject.end_time }}
                        </td>
                        <td class="py-4 px-6 border-b min-w-[120px]">{{ subject.room }}</td>
                        <td class="py-4 px-6 border-b min-w-[200px]">
                            {% if subject.invigilator %}
                                {{ subject.invigilator.user.first_name }} {{ subject.invigilator.user.last_name }}
                            {% else %}
                                -
                            {% endif %}
                        </td>
                        <td class="py-4 px-6 border-b flex flex-wrap gap-2">
                            <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç -->
                            <a href="{% url 'edit_exam_subject' subject.id %}" class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-2 rounded-md transition">
                                ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                            </a>
                            <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö -->
                            <a href="{% url 'delete_exam_subject' subject.id %}" class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-md transition"
                               onclick="return confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏ô‡∏µ‡πâ?')">
                                üóëÔ∏è ‡∏•‡∏ö
                            </a>
                            <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code -->
                            <a href="{% url 'generate_qr_code' subject.id %}" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md transition">
                                üì± ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="8" class="text-center text-gray-600 py-6 text-xl">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
