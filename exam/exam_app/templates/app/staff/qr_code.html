<!-- qr_code.html -->

{% extends "app/base.html" %}

{% block content %}
<div class="max-w-4xl mx-auto py-12 px-6 sm:px-8 lg:px-10 text-center">
    <h2 class="text-5xl font-extrabold text-indigo-700 mb-4 flex items-center justify-center gap-1 whitespace-nowrap">
        üìå <span>QR Code ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤:</span><span class="text-indigo-800">{{ subject.subject_name }}</span>
    </h2>

    <!-- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå -->
    <div class="flex justify-center items-center text-4xl font-extrabold text-red-500 mb-6">
        <span class="mr-2">‚è∞</span> <span id="current-time">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
    </div>

    <!-- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á QR Code ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà -->
    <div class="bg-white shadow-xl rounded-2xl p-10 inline-block transition transform hover:scale-105">
        <img src="data:image/png;base64,{{ img_base64 }}" alt="QR Code"
            class="mx-auto max-w-md border-4 border-gray-300 rounded-lg shadow-md">
        <p class="text-xl text-gray-700 mt-4 font-semibold">üì± ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
    </div>

    <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö -->
    <div class="flex justify-center mt-10">
        <button onclick="copyQRCodeURL()"
            class="bg-blue-600 hover:bg-blue-700 text-white px-10 py-4 text-lg rounded-xl shadow-lg transition-transform transform hover:scale-105">
            üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≠‡∏ö
        </button>
    </div>

    <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå QR Code ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤ -->
    <div class="flex justify-center mt-6 space-x-6">
        <button onclick="window.print()"
            class="bg-green-600 hover:bg-green-700 text-white px-10 py-4 text-lg rounded-xl shadow-lg transition-transform transform hover:scale-105">
            üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå QR Code
        </button>
        <a href="{% url 'exam_subjects_staff' %}"
            class="bg-indigo-600 hover:bg-indigo-700 text-white px-10 py-4 text-lg rounded-xl shadow-lg transition-transform transform hover:scale-105">
            üîô ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤
        </a>
    </div>
</div>

<!-- ‚úÖ JavaScript ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå -->
<script>
    function updateTime() {
        const now = new Date();
        now.setHours(now.getHours() + 7); // ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ó‡∏¢ (UTC+7)

        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');

        document.getElementById("current-time").textContent = `${hours}:${minutes}:${seconds}`;
    }

    function copyQRCodeURL() {
        const qrUrl = "{{ qr_url }}"; // ‚úÖ ‡∏î‡∏∂‡∏á URL ‡∏à‡∏≤‡∏Å Django
        navigator.clipboard.writeText(qrUrl).then(() => {
            alert("‚úÖ ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ä‡∏£‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ");
        }).catch(err => {
            console.error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå:", err);
            alert("‚ùå ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå");
        });
    }

    setInterval(updateTime, 1000);
    updateTime();
</script>

{% endblock %}

<!-- ‚úÖ CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå -->
{% block extra_css %}
<style>
    @media print {
        body * {
            visibility: hidden;
        }

        .container,
        .container * {
            visibility: visible;
        }

        .container {
            position: absolute;
            left: 0;
            top: 0;
        }

        .container img {
            width: 100%;
            /* ‚úÖ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ QR Code ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© */
        }
    }
</style>
{% endblock %}